<!DOCTYPE html>
<html>
<head>
    <title>PubTrends - Publication Analysis Service</title>
    <meta charset="utf-8">
    <link rel="stylesheet"
          href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
          crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css"
          integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt"
          crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha384-tsQFqpEReu7ZLhBV2VZlAu7zcOV+rXbYlF2cqB8txI/8aZajjp4Bqd+V6D5IgvKT"
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
            crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
            integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
            crossorigin="anonymous"></script>
    <script src="https://cdn.pydata.org/bokeh/release/bokeh-1.2.0.min.js"></script>
    <script src="https://cdn.pydata.org/bokeh/release/bokeh-widgets-1.2.0.min.js"></script>
    <script src="https://cdn.pydata.org/bokeh/release/bokeh-tables-1.2.0.min.js"></script>
    <link href="https://cdn.pydata.org/bokeh/release/bokeh-1.2.0.min.css"
          rel="stylesheet" type="text/css">
    <link href="https://cdn.pydata.org/bokeh/release/bokeh-widgets-1.2.0.min.css"
          rel="stylesheet" type="text/css">
    <link href="https://cdn.pydata.org/bokeh/release/bokeh-tables-1.2.0.min.css"
          rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}"/>
    <!--     <link rel="stylesheet" href="../static/style.css"/> -->
    <link rel="stylesheet" href="{{ url_for('static', filename='result.css') }}">
    <!--    <link rel="stylesheet" href="../static/result.css"/>-->
</head>
<body>

<!-- Fixed navbar -->
<nav class="navbar navbar-light bg-light justify-content-start fixed-top border-bottom">
    <span class="navbar-brand col-sm-3 col-md-2 col-xl-2 mr-0">
        <a id="pubtrends" class="navbar-brand" href="/">PubTrends</a>
    </span>
    <span class="search-string">
        {{ search_string }}
    </span>
</nav>

<div class="container-fluid">
    <div class="row">
        <!-- Sticky sidebar -->
        <nav class="col-md-2 col-xl-2 d-none d-md-block bg-light sidebar border-bottom">
            <div class="sidebar-sticky">
                <ul class="nav flex-column mt-3">
                    <li class="nav-item">
                        <a class="nav-link" href="#overview">
                            <img src="{{ url_for('static', filename='home.svg') }}"/>&nbsp;Overview
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#highlights">
                            <img src="{{ url_for('static', filename='bar-chart-2.svg') }}"/>&nbsp;Highlights
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#topics">
                            <img src="{{ url_for('static', filename='tag.svg') }}"/>&nbsp;Topics
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#trends">
                            <img src="{{ url_for('static', filename='trending-up.svg') }}"/>&nbsp;Trends
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#authors">
                            <img src="{{ url_for('static', filename='users.svg') }}"/>&nbsp;Authors
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#journals">
                            <img src="{{ url_for('static', filename='book-open.svg') }}"/>&nbsp;Journals
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#publications">
                            <img src="{{ url_for('static', filename='columns.svg') }}"/>&nbsp;Publications
                        </a>
                    </li>
                    {% if experimental %}
                    <li class="nav-item">
                        <a class="nav-link" href="#evolution">
                            <img src="{{ url_for('static', filename='flag.svg') }}"/>&nbsp;Experimental
                        </a>
                    </li>
                    {% endif %}
                    <li class="nav-item">
                        <a class="nav-link" href="#log">
                            <img src="{{ url_for('static', filename='align-justify.svg') }}"/>&nbsp;Log
                        </a>
                    </li>
                </ul>
            </div>
        </nav>

        <!-- Main content -->
        <main class="col-12 col-md-auto col-xl-10 justify-content-between" role="main">
            <div class="card mt-3">
                <div class="card-title" id="overview">
                    <h2 class="card-header">Overview</h2>
                </div>
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-sm-4">
                            <div class="card">
                                <div class="card-body text-center">
                                    <span class="stats-number"><b>{{ n_papers }}</b></span><br>
                                    <span class="card-text">papers</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="card">
                                <div class="card-body text-center">
                                    <span class="stats-number"><b>{{ n_citations }}</b></span><br>
                                    <span class="card-text">citations</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="card">
                                <div class="card-body text-center">
                                    <span class="stats-number"><b>{{ n_subtopics }}</b></span><br>
                                    <span class="card-text">subtopics</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>
                        {% for script, div in papers_stats %}
                        {{ script|safe }}
                        {{ div|safe }}
                        {% endfor %}
                    </div>
                    <p>
                        Explore related papers by taking into account all the referencing and citing relationships for papers of interest.<br>
                        <strong>WARNING</strong>: number of papers can increase exponentially, analysis can be slow!
                    </p>
                    <button type="button" class="btn btn-light"
                            onclick="(function(){ {{ papers_zoom_out_callback|safe }} })();">
                        <img src="{{ url_for('static', filename='zoom-out.svg') }}" alt="-"/>&nbsp;Zoom out to related papers
                    </button>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-title" id="highlights">
                    <h1 class="card-header">Highlights</h1>
                </div>
                <div class="card-body">
                    <h2 class="card-subtitle">Top Cited Papers Overall</h2>
                    <p>
                        Top 50 or 10% cited papers are shown among all the papers for given terms.<br>
                        Year reflects publication year of the original paper.
                    </p>
                    <div>
                        {% for script, div in top_cited_papers %}
                        {{ script|safe }}
                        {{ div|safe }}
                        {% endfor %}
                    </div>

                    <h2 class="card-subtitle">Top Cited Papers of the Year</h2>
                    <p>
                        For each year we show the paper which has the most significant number of citations in a given
                        year.<br>
                        Different papers have different colors.
                    </p>
                    <div>
                        {% for script, div in max_gain_papers %}
                        {{ script|safe }}
                        {{ div|safe }}
                        {% endfor %}
                    </div>

                    <h2 class="card-subtitle">Hot Papers</h2>
                    <p>
                        For each year we show a recent paper which has the biggest number of citation since the moment
                        of publication. <br>
                        Different papers have different colors.
                    </p>
                    <div>
                        {% for script, div in max_relative_gain_papers %}
                        {{ script|safe }}
                        {{ div|safe }}
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-title" id="topics">
                    <h1 class="card-header">Topics</h1>
                </div>
                <div class="card-body">
                    <p> Citations graph is used to find all the papers which are cited together or <em>co-cited</em> by
                        other papers.<br>
                        Co-citations graph is used to extract subtopics using <em>Louvain</em> algorithm for community detection.<br>
                        Click on bars to get detailed information about keywords and publications for each subtopic.
                        <br>
                        <em>Note: subtopics are merged to "Other" if they contain less than 5% of publications of the
                            field.</em>
                    </p>
                    <div>
                        {% for script, div in component_ratio %}
                        {{ script|safe }}
                        {{ div|safe }}
                        {% endfor %}
                    </div>

                    <h2 class="card-subtitle">Papers co-citations clustering</h2>
                    <p> {{clusters_info_message}} </p>
                    <div>
                        {% for script, div in cocitations_clusters %}
                        {{ script|safe }}
                        {{ div|safe }}
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-title" id="trends">
                    <h1 class="card-header">Trends</h1>
                </div>
                <div class="card-body">
                    <h2 class="card-subtitle">Subtopics summary</h2>
                    <p>
                        Explore the evolution of trends - dynamics is shown for the timeline.<br>
                        Colors are the same as in the previous diagram.
                    </p>
                    <div>
                        {% for script, div in component_size_summary %}
                        {{ script|safe }}
                        {{ div|safe }}
                        {% endfor %}
                    </div>
                    <br>
                    <p>Each boxplot demonstrates summary publication year for given topic.</p>
                    <div>
                        {% for script, div in component_years_summary_boxplots %}
                        {{ script|safe }}
                        {{ div|safe }}
                        {% endfor %}
                    </div>

                </div>
            </div>

            <div class="card mt-3">
                <div class="card-title" id="authors">
                    <h1 class="card-header">Authors</h1>
                </div>
                <div class="card-body">
                    <p>
                        List of authors with the largest number of papers for given terms.<br>
                        The colors of the circles in the subtopics column indicate top 3 most common subtopics among
                        these papers.<br>
                        The subtopic circles are arranged according to the number of papers, in descending order.
                    </p>
                    <table class="table table-sm table-bordered table-striped">
                        <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">Author</th>
                            <th scope="col">Number of papers</th>
                            <th scope="col">Subtopics</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for row in author_statistics %}
                        <tr>
                            <th scope="row">{{ loop.index }}</th>
                            <td>{{ row[0] }}</td>
                            <td>{{ row[1] }}</td>
                            <td>{{ row[2]|safe }}</td>
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-title" id="journals">
                    <h1 class="card-header">Journals</h1>
                </div>
                <div class="card-body">
                    <p>
                        List of journals with the largest number of papers for given terms.<br>
                        The colors of the circles in the subtopics column indicate top 3 most common subtopics among
                        these papers.<br>
                        The subtopic circles are arranged according to the number of papers, in descending order.
                    </p>
                    <table class="table table-sm table-bordered table-striped">
                        <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">Journal</th>
                            <th scope="col">Number of papers</th>
                            <th scope="col">Subtopics</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% for row in journal_statistics %}
                        <tr>
                            <th scope="row">{{ loop.index }}</th>
                            <td>{{ row[0] }}</td>
                            <td>{{ row[1] }}</td>
                            <td>{{ row[2]|safe }}</td>
                        </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-title" id="publications">
                    <h1 class="card-header">Publications</h1>
                </div>
                <div class="card-body">
                    <p>
                        Learn more about subtopics - most cited papers over time are shown for each topic.<br>
                        Papers are sorted descending by citations number overall from bottom to top.<br>
                        Year reflects publication year of the original paper.
                    </p>
                    <div>
                        {% for (script, div), zoom_in_callback in subtopics_infos_and_zoom_in_callbacks %}
                        <h2 class="card-subtitle">
                            Subtopic {{ loop.index }}
                            {% if loop.index0 == comp_other %}
                            - OTHER
                            {% endif %}
                            <button type="button" class="btn btn-light"
                                    onclick="(function(){ {{ zoom_in_callback|safe }} })();">
                                <img src="{{ url_for('static', filename='zoom-in.svg') }}"  alt="+"/>&nbsp;Zoom into
                            </button>
                        </h2>
                        Size: {{ component_sizes[loop.index - 1] }}
                        <div id="subtopic-{{ loop.index }}">
                            {{ script|safe }}
                            {{ div|safe }}
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            {% if experimental %}
            <div class="card mt-3">
                <div class="card-title" id="evolution">
                    <h1 class="card-header">Experimental</h1>
                </div>
                <div class="card-body">
                    <h2 class="card-subtitle">Subtopic Evolution</h2>
                    <p>
                        Topics extraction is performed longitudinally at several time points to detect merges and splits
                        of clusters,<br>
                        which can be related to new ideas. Clusters are described by several words with the highest<br>
                        <em>TF-IDF</em> value, edge width reflects the number of papers which moved from one cluster to
                        another.
                    </p>
                    <div>
                        {% if subtopic_evolution is defined %}
                        {% for script, div in subtopic_evolution %}
                        {{ script|safe }}
                        {{ div|safe }}
                        {% endfor %}
                        {% else %}
                        Failed to analyze subtopic evolution because year step is too big.
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endif %}

            <div class="card mt-3">
                <div class="card-title" id="log">
                    <h1 class="card-header">Log</h1>
                </div>
                <div class="card-body">
                    <pre>{{log}}</pre>
                </div>
            </div>
        </main>
    </div>
</div>
<footer>
    <p>version {{ version }}<br/>
        &copy;2019 <a href="https://research.jetbrains.org/groups/biolabs"
                      title="JetBrains Research BioLabs"
                      target="_blank">JetBrains Research</a></p>
</footer>
</body>
</html>