import psycopg2class PostgresConnector:    def __init__(self, pubtrends_config, connect=True, readonly=True):        self.config = pubtrends_config        self.postgres_connection = None        if not connect:            return        if PostgresConnector.postgres_configured(pubtrends_config):            try:                connection_string = f"""                    host={pubtrends_config.postgres_host} \                    port={pubtrends_config.postgres_port} \                    dbname={pubtrends_config.postgres_database} \                    user={pubtrends_config.postgres_username} \                    password={pubtrends_config.postgres_password}                """.strip()                self.postgres_connection = psycopg2.connect(connection_string,)                if readonly:                    self.postgres_connection.set_session(readonly=True)            except Exception:                raise Exception('Failed to connect to database.')    def close_connection(self):        if self.postgres_connection:            self.postgres_connection.close()    @staticmethod    def postgres_configured(pubtrends_config):        return pubtrends_config.postgres_host and \               pubtrends_config.postgres_port and \               pubtrends_config.postgres_database and \               pubtrends_config.postgres_username and \               pubtrends_config.postgres_password